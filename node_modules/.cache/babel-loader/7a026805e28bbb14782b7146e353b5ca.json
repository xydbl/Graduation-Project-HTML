{"remainingRequest":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\babel-loader\\lib\\index.js!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\Editing.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\Editing.vue","mtime":1661326797914},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\babel-loader\\lib\\index.js","mtime":1660272402348},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js","mtime":1660272406551}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.last-index-of\";\nimport _objectSpread from \"D:\\\\HBuilderProjects\\\\vue2\\\\Graduation-Project-HTML\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// 发布 博客\n// import axios from 'axios'\nimport { mapState, mapMutations } from 'vuex';\nexport default {\n  name: 'Editing',\n  data: function data() {\n    return {\n      title: '',\n      type: '',\n      content: '',\n      newTime: +new Date(),\n      fromData: {},\n      img: ''\n    };\n  },\n  methods: _objectSpread({}, mapMutations('blogOptions', {\n    updateBid: 'UPDATEBID'\n  }), {\n    // 标题是否可用\n    titleIsTrue: function titleIsTrue() {\n      var _this = this;\n\n      this.$axios.get(\"http://localhost:8081/api/blog/findByTitle/\".concat(this.title)).then(function (res) {\n        if (res.data) {\n          _this.$message.warning('标题不可用');\n        }\n      }, function (error) {\n        console.log(error.message);\n      });\n    },\n    // \n    save: function save() {\n      var _this2 = this;\n\n      this.$axios.post(\"http://localhost:8081/api/blog/save\", {\n        bid: this.bid,\n        buid: this.user.uid,\n        btitle: this.title,\n        btype: this.type,\n        bcontent: this.content,\n        btime: +new Date(),\n        bstate: 0\n      }).then(function (res) {\n        if (res.data) {\n          // alert(\"保存成功\")\n          _this2.$message.success('保存成功');\n\n          sessionStorage.setItem(\"editing\", JSON.stringify(res.data));\n          _this2.updateBid = res.data.bid;\n          console.log(res.data);\n        }\n      }, function (error) {\n        alert(\"保存失败\");\n        console.log(error.message);\n      });\n    },\n    // 保存saveBlog 所有 只在设置封面时调用 已放弃此方法\n    // saveBlog(){\n    // \tthis.$bus.obj.append(\"btitle\",this.title)\n    // \tthis.$bus.obj.append(\"buid\",this.user.uid)\n    // \tthis.$bus.obj.append(\"btype\",this.type)\n    // \tthis.$bus.obj.append(\"bcontent\",this.content)\n    // \tthis.$bus.obj.append(\"btime\",new Date())\n    // \tthis.$bus.obj.append(\"bstate\",0)\n    // \tthis.$nextTick(function(){\n    // \t\tthis.$axios({\n    // \t\t\tmethod:'post',\n    // \t\t\turl:'http://localhost:8081/api/blog/saveBlog',\n    // \t\t\theaders:{\"Content-Type\":\"multipart/form-data\"},\n    // \t\t\tdata:this.$bus.obj\n    // \t\t}).then(res=>{\n    // \t\t\t// this.$refs.clear1.clearFiles()\n    // \t\t\t// console.log(res.data);\n    // \t\t\tthis.updateBid(res.data.bid)\n    // \t\t\tthis.img=res.data.bimage\n    // \t\t},\n    // \t\terror=>{\n    // \t\t\tconsole.log(error.message);\n    // \t\t})\n    // \t})\n    // },\n    // 发布\n    pushBlog: function pushBlog() {\n      var _this3 = this;\n\n      console.log(this.bid, this.user.uid);\n      this.$axios.post('http://localhost:8081/api/blog/save', {\n        bid: this.bid,\n        buid: this.user.uid,\n        btitme: this.title,\n        btype: this.type,\n        bcontent: this.content,\n        btime: this.newTime,\n        bstate: 1,\n        bclick: 0\n      }).then(function (res) {\n        if (res.data) {\n          // alert(\"发布成功\")\n          _this3.$router.back();\n\n          _this3.updateBid('');\n        }\n      }, function (error) {\n        alert('发布失败');\n        console.log(error.message);\n      });\n    },\n    // 上传图片\n    uploadBlogImg: function uploadBlogImg(params) {\n      var file = params.file;\n      var index = file.name.lastIndexOf(\".\");\n      var extension = file.name.substr(index + 1);\n      var extensionList = [\"png\", \"PNG\", \"jpg\", \"JPG\", \"jpeg\", \"JPEG\"];\n      var isLimit = file.size / 1024 / 1024 < 10;\n\n      if (!isLimit) {\n        alert(\"文件大小超过10M\");\n      } else if (extensionList.indexOf(extension) < 0) {\n        alert(\"文件格式不支持\");\n      } else {\n        var obj = new FormData();\n        obj.append('file', file);\n        obj.append('bid', this.bid); // this.saveBlog()\n\n        obj.append(\"btitle\", this.title);\n        obj.append(\"buid\", this.user.uid);\n        obj.append(\"btype\", this.type);\n        obj.append(\"bcontent\", this.content);\n        obj.append(\"btime\", +new Date());\n        obj.append(\"bstate\", 0);\n        this.$nextTick(function () {\n          var _this4 = this;\n\n          this.$axios({\n            method: 'post',\n            url: 'http://localhost:8081/api/blog/saveBlog',\n            // headers:{\"Content-Type\":\"multipart/form-data\"},\n            data: obj\n          }).then(function (res) {\n            // this.$refs.clear1.clearFiles()\n            // console.log(this.$refs.clear1.clearFiles());\n            // console.log(res.data);\n            // file.clearFiles()\n            _this4.updateBid(res.data.bid);\n\n            _this4.img = res.data.bimage;\n            sessionStorage.setItem(\"editing\", JSON.stringify(res.data)); // localStorage.setItem(\"editing\",res.data)\n          }, function (error) {\n            console.log(error.message);\n          });\n        });\n      }\n    },\n    // mavon-editor 图片上传\n    imgAdd1: function imgAdd1(pos, file) {\n      var _this5 = this;\n\n      var formData = new FormData();\n      formData.append('file', file);\n      this.$axios({\n        method: 'post',\n        url: 'http://localhost:8081/api/mavon/addImg',\n        data: formData\n      }).then(function (res) {\n        var url = '/MavonImg/' + res.data;\n\n        _this5.$refs.edingMd.$img2Url(pos, url);\n      });\n    }\n  }),\n  computed: _objectSpread({}, mapState('userOptions', {\n    user: 'user'\n  }), mapState('blogOptions', {\n    bid: 'bid'\n  })),\n  mounted: function mounted() {\n    var editing = sessionStorage.getItem(\"editing\"); // console.log(editing!=''&&editing!=null);\n\n    if (editing != '' && editing != null) {\n      var editblog = JSON.parse(editing);\n      this.updateBid(editblog.bid);\n      this.title = editblog.btitle;\n      this.type = editblog.btype;\n      this.content = editblog.bcontent;\n      this.img = editblog.bimage;\n    }\n  }\n};",{"version":3,"sources":["Editing.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div class=\"editing\">\r\n\t\t<div class=\"left\">\r\n\t\t\t<span>请输入标题：</span><br>\r\n\t\t\t<span>类型：</span><br>\r\n\t\t\t<span>请选择封面：</span><br>\r\n\t\t\t<div style=\"position: relative;top: 200px;\">\r\n\t\t\t\t<span>内容：</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"top\">\r\n\t\t\t<button @click=\"save\">保存</button>\r\n\t\t\t<button @click=\"pushBlog\">发布</button>\r\n\t\t</div>\r\n\t\t<div class=\"right\">\r\n\t\t\t<input type=\"text\" class=\"titleIn inputcss\" v-model=\"title\" @input=\"titleIsTrue\"><br>\r\n\t\t\t<input type=\"text\" class=\"inputcss\" v-model=\"type\" >\r\n\t\t\t<!-- <select name=\"\" class=\"stype\" v-model=\"type\">\r\n\t\t\t\t<option value=\"\">xxxx</option>\r\n\t\t\t</select><br> -->\r\n\t\t\t<!-- <input type=\"file\" class=\"checkImg\" accept=\".png, .jpg, .jpeg\"><br> -->\r\n\t\t\t<div class=\"uploadBlogImage\">\r\n\t\t\t\t<el-upload\r\n\t\t\t\t\tclass=\"upload-demo\" \r\n\t\t\t\t\tdrag \r\n\t\t\t\t\taction=\"\" \r\n\t\t\t\t\t:http-request=\"uploadBlogImg\" \r\n\t\t\t\t\t:limit=\"1\" \r\n\t\t\t\t\tmultiple>\r\n\t\t\t\t\t<img v-if=\"img\" :src=\"require('../assets/blogimage/'+img)\" style=\"width:100%;height:100%\">\r\n\t\t\t\t\t<i v-else class=\"el-icon-upload\"></i>\r\n\t\t\t\t\t<div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n\t\t\t\t\t<div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过10M,只能上传一个文件</div>\r\n\t\t\t\t</el-upload>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"mavonEditor\">\r\n\t\t\t\t<mavon-editor v-model=\"content\" @imgAdd=\"imgAdd1\" @click=\"save\" ref=\"edingMd\" />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n// 发布 博客\r\n// import axios from 'axios'\r\nimport { mapState, mapMutations } from 'vuex'\r\nexport default {\r\n    name:'Editing',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttitle:'',\r\n\t\t\ttype:'',\r\n\t\t\tcontent:'',\r\n\t\t\tnewTime:+new Date(),\r\n\t\t\tfromData:{},\r\n\t\t\timg:''\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapMutations('blogOptions',{updateBid:'UPDATEBID'}),\r\n\t\t// 标题是否可用\r\n\t\ttitleIsTrue(){\r\n\t\t\tthis.$axios.get(`http://localhost:8081/api/blog/findByTitle/${this.title}`)\r\n\t\t\t.then(res=>{\r\n\t\t\t\tif(res.data){\r\n\t\t\t\t\tthis.$message.warning('标题不可用')\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror=>{\r\n\t\t\t\tconsole.log(error.message);\r\n\t\t\t})\r\n\t\t},\r\n\t\t// \r\n\t\tsave(){\r\n\t\t\tthis.$axios.post(\"http://localhost:8081/api/blog/save\",{\r\n\t\t\t\tbid:this.bid,\r\n\t\t\t\tbuid:this.user.uid,\r\n\t\t\t\tbtitle:this.title,\r\n\t\t\t\tbtype:this.type,\r\n\t\t\t\tbcontent:this.content,\r\n\t\t\t\tbtime:+new Date(),\r\n\t\t\t\tbstate:0\r\n\t\t\t}).then(res=>{\r\n\t\t\t\tif(res.data){\r\n\t\t\t\t\t// alert(\"保存成功\")\r\n\t\t\t\t\tthis.$message.success('保存成功')\r\n\t\t\t\t\tsessionStorage.setItem(\"editing\",JSON.stringify(res.data))\r\n\t\t\t\t\tthis.updateBid=res.data.bid\r\n\t\t\t\t\tconsole.log(res.data);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror=>{\r\n\t\t\t\talert(\"保存失败\")\r\n\t\t\t\tconsole.log(error.message);\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 保存saveBlog 所有 只在设置封面时调用 已放弃此方法\r\n\t\t// saveBlog(){\r\n\t\t// \tthis.$bus.obj.append(\"btitle\",this.title)\r\n\t\t// \tthis.$bus.obj.append(\"buid\",this.user.uid)\r\n\t\t// \tthis.$bus.obj.append(\"btype\",this.type)\r\n\t\t// \tthis.$bus.obj.append(\"bcontent\",this.content)\r\n\t\t// \tthis.$bus.obj.append(\"btime\",new Date())\r\n\t\t// \tthis.$bus.obj.append(\"bstate\",0)\r\n\t\t// \tthis.$nextTick(function(){\r\n\t\t// \t\tthis.$axios({\r\n\t\t// \t\t\tmethod:'post',\r\n\t\t// \t\t\turl:'http://localhost:8081/api/blog/saveBlog',\r\n\t\t// \t\t\theaders:{\"Content-Type\":\"multipart/form-data\"},\r\n\t\t// \t\t\tdata:this.$bus.obj\r\n\t\t// \t\t}).then(res=>{\r\n\t\t// \t\t\t// this.$refs.clear1.clearFiles()\r\n\t\t// \t\t\t// console.log(res.data);\r\n\t\t// \t\t\tthis.updateBid(res.data.bid)\r\n\t\t// \t\t\tthis.img=res.data.bimage\r\n\t\t// \t\t},\r\n\t\t// \t\terror=>{\r\n\t\t// \t\t\tconsole.log(error.message);\r\n\t\t// \t\t})\r\n\t\t// \t})\r\n\t\t// },\r\n\t\t// 发布\r\n\t\tpushBlog() {\r\n\t\t\tconsole.log(this.bid,this.user.uid);\r\n\t\t\tthis.$axios.post('http://localhost:8081/api/blog/save',{\r\n\t\t\t\tbid:this.bid,\r\n\t\t\t\tbuid:this.user.uid,\r\n\t\t\t\tbtitme:this.title,\r\n\t\t\t\tbtype:this.type,\r\n\t\t\t\tbcontent:this.content,\r\n\t\t\t\tbtime:this.newTime,\r\n\t\t\t\tbstate:1,\r\n\t\t\t\tbclick:0\r\n\t\t\t}).then(res=>{\r\n\t\t\t\tif(res.data){\r\n\t\t\t\t\t// alert(\"发布成功\")\r\n\t\t\t\t\tthis.$router.back()\r\n\t\t\t\t\tthis.updateBid('')\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror=>{\r\n\t\t\t\talert('发布失败')\r\n\t\t\t\tconsole.log(error.message);\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 上传图片\r\n\t\tuploadBlogImg(params){\r\n\t\t\tlet file=params.file\r\n\t\t\tlet index=file.name.lastIndexOf(\".\")\r\n\t\t\tlet extension=file.name.substr(index+1)\r\n\t\t\tlet extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n\t\t\tconst isLimit=file.size / 1024 / 1024 < 10;\r\n\t\t\tif(!isLimit){\r\n\t\t\t\talert(\"文件大小超过10M\")\r\n\t\t\t}else if(extensionList.indexOf(extension)<0){\r\n\t\t\t\talert(\"文件格式不支持\")\r\n\t\t\t}else{\r\n\t\t\t\tlet obj=new FormData()\r\n\t\t\t\tobj.append('file',file)\r\n\t\t\t\tobj.append('bid',this.bid)\r\n\t\t\t\t// this.saveBlog()\r\n\t\t\t\tobj.append(\"btitle\",this.title)\r\n\t\t\t\tobj.append(\"buid\",this.user.uid)\r\n\t\t\t\tobj.append(\"btype\",this.type)\r\n\t\t\t\tobj.append(\"bcontent\",this.content)\r\n\t\t\t\tobj.append(\"btime\",+new Date())\r\n\t\t\t\tobj.append(\"bstate\",0)\r\n\t\t\t\tthis.$nextTick(function(){\r\n\t\t\t\t\tthis.$axios({\r\n\t\t\t\t\t\tmethod:'post',\r\n\t\t\t\t\t\turl:'http://localhost:8081/api/blog/saveBlog',\r\n\t\t\t\t\t\t// headers:{\"Content-Type\":\"multipart/form-data\"},\r\n\t\t\t\t\t\tdata:obj\r\n\t\t\t\t\t}).then(res=>{\r\n\t\t\t\t\t\t// this.$refs.clear1.clearFiles()\r\n\t\t\t\t\t\t// console.log(this.$refs.clear1.clearFiles());\r\n\t\t\t\t\t\t// console.log(res.data);\r\n\t\t\t\t\t\t// file.clearFiles()\r\n\t\t\t\t\t\tthis.updateBid(res.data.bid)\r\n\t\t\t\t\t\tthis.img=res.data.bimage\r\n\t\t\t\t\t\tsessionStorage.setItem(\"editing\",JSON.stringify(res.data) )\r\n\t\t\t\t\t\t// localStorage.setItem(\"editing\",res.data)\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror=>{\r\n\t\t\t\t\t\tconsole.log(error.message);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t// mavon-editor 图片上传\r\n\t\timgAdd1(pos,file){\r\n\t\t\tlet formData=new FormData()\r\n\t\t\tformData.append('file',file)\r\n\t\t\tthis.$axios({\r\n\t\t\t\tmethod:'post',\r\n\t\t\t\turl:'http://localhost:8081/api/mavon/addImg',\r\n\t\t\t\tdata:formData\r\n\t\t\t})\r\n\t\t\t.then(res=>{\r\n\t\t\t\tlet url='/MavonImg/'+res.data\r\n\t\t\t\tthis.$refs.edingMd.$img2Url(pos,url)\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\tcomputed:{\r\n\t\t...mapState('userOptions',{user:'user'}),\r\n\t\t...mapState('blogOptions',{bid:'bid'}),\r\n\t},\r\n\tmounted() {\r\n\t\tlet editing=sessionStorage.getItem(\"editing\")\r\n\t\t// console.log(editing!=''&&editing!=null);\r\n\t\tif(editing!=''&&editing!=null){\r\n\t\t\tlet editblog=JSON.parse(editing)\r\n\t\t\tthis.updateBid(editblog.bid)\r\n\t\t\tthis.title=editblog.btitle\r\n\t\t\tthis.type=editblog.btype\r\n\t\t\tthis.content=editblog.bcontent\r\n\t\t\tthis.img=editblog.bimage\r\n\t\t}\r\n\t},\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.editing{\r\n\twidth: 1200px;\r\n\theight: 780px;\r\n\tposition: relative;\r\n\tleft: 200px;\r\n\ttop: 20px;\r\n\tborder: 1px solid silver;\r\n\tborder-bottom: 0;\r\n}\r\n.top{\r\n\tposition: relative;\r\n\ttop: -485px;\r\n\tleft: 1040px;\r\n\twidth: 200px;\r\n}\r\n.top button{\r\n\tmargin: 10px;\r\n}\r\n.left{\r\n\tposition: relative;\r\n\twidth: 130px;\r\n\theight: 500px;\r\n\tleft: 20px;\r\n\tfont-size: 18px;\r\n\ttext-align: right;\r\n}\r\n.right{\r\n\tposition: relative;\r\n\twidth: 1000px;\r\n\theight: 600px;\r\n\ttop: -460px;\r\n\tleft: 160px;\r\n}\r\ninput{\r\n\theight: 30px;\r\n\twidth: 360px;\r\n}\r\nspan{\r\n\tmargin: 10px;\r\n\tline-height: 50px;\r\n}\r\n.titleIn{\r\n\tposition: relative;\r\n\ttop: -15px;\r\n\tmargin-top: 10px;\r\n\tborder-top: 0;\r\n\tborder-left: 0;\r\n\tborder-right: 0;\r\n\tborder-bottom: 1px solid darkgrey;\r\n\toutline: none;\r\n}\r\n.stype{\r\n\tposition: relative;\r\n\ttop: 21px;\r\n\theight: 30px;\r\n\twidth: 70px;\r\n}\r\n/* .checkImg{\r\n\tposition: relative;\r\n\ttop: 55px;\r\n\tleft: -370px;\r\n} */\r\n.uploadBlogImage{\r\n\tposition: relative;\r\n\ttop: 30px;\r\n}\r\n/* .ptext{\r\n\tposition: relative;\r\n\ttop: 50px;\r\n} */\r\n.mavonEditor{\r\n\tposition: relative;\r\n\ttop: 80px;\r\n\theight: 400px;\r\n}\r\n/* .btn{\r\n\tposition: relative;\r\n\ttop: 10px;\r\n\twidth: 60px;\r\n\theight: 30px;\r\n} */\r\n.inputcss{\r\n\tborder-top: 0;\r\n\tborder-left: 0;\r\n\tborder-right: 0;\r\n\tborder-bottom: 1px solid darkgrey;\r\n\toutline: none;\r\n}\r\n</style>"],"sourceRoot":"src/components"}]}