{"remainingRequest":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\babel-loader\\lib\\index.js!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\UploadImage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\UploadImage.vue","mtime":1661245008037},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\babel-loader\\lib\\index.js","mtime":1660272402348},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js","mtime":1660272406551}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.last-index-of\";\nimport _objectSpread from \"D:\\\\HBuilderProjects\\\\vue2\\\\Graduation-Project-HTML\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState, mapMutations } from 'vuex'; // import {filesArray} from '@/api/curriculum'\n\nexport default {\n  name: 'UploadImage',\n  data: function data() {\n    return {\n      // coverImg:'',\n      loadingstate: false\n    };\n  },\n  methods: _objectSpread({}, mapMutations('userOptions', {\n    updateUserMessage: 'UPDATEUSERMESSAGE'\n  }), {\n    // beforeUpload(file){\n    //   this.loadingstate=true\n    //   let index=file.name.lastIndexOf(\".\")\n    //   let extension=file.name.substr(index+1)\n    //   let extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\n    //   const isLimit=file.size / 1024 / 1024 < 10;\n    //   if (!isLimit) {\n    //     return false\n    //   }else if(extensionList.indexOf(extension)<0){\n    //     return false\n    //   }else{\n    //   }\n    // },\n    uploadImg: function uploadImg(params) {\n      var _this = this;\n\n      var file = params.file; // console.log(file);\n      // console.log(params);\n      // let reader=new FileReader()\n      // reader.readAsDataURL(file.raw)\n      // console.log(reader.result);\n\n      this.loadingstate = true;\n      var index = file.name.lastIndexOf(\".\");\n      var extension = file.name.substr(index + 1);\n      var extensionList = [\"png\", \"PNG\", \"jpg\", \"JPG\", \"jpeg\", \"JPEG\"];\n      var isLimit = file.size / 1024 / 1024 < 10;\n\n      if (!isLimit) {\n        alert(\"文件大小超过10M\");\n      } else if (extensionList.indexOf(extension) < 0) {\n        alert(\"文件格式不支持\");\n      } else {\n        var obj = new FormData();\n        var username = localStorage.getItem('username');\n        obj.append(\"username\", username);\n        obj.append(\"file\", file);\n        this.$axios({\n          method: \"post\",\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          },\n          url: 'http://localhost:8081/api/user/uploadImage',\n          data: obj\n        }).then(function (res) {\n          _this.$refs.clear.clearFiles();\n\n          if (!res.data) {\n            alert(\"文件为空\");\n          } else {\n            _this.updateUserMessage();\n          }\n        }, function (error) {\n          alert(\"上传失败\");\n          console.log(error.message);\n        });\n      }\n    }\n  }),\n  computed: _objectSpread({}, mapState('userOptions', {\n    user: 'user'\n  }))\n};",{"version":3,"sources":["UploadImage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAoBA,SAAA,QAAA,EAAA,YAAA,QAAA,MAAA,C,CACA;;AACA,eAAA;AACA,EAAA,IAAA,EAAA,aADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA;AACA,MAAA,YAAA,EAAA;AAFA,KAAA;AAIA,GAPA;AAQA,EAAA,OAAA,oBAEA,YAAA,CAAA,aAAA,EAAA;AAAA,IAAA,iBAAA,EAAA;AAAA,GAAA,CAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAA,SAjBA,qBAiBA,MAjBA,EAiBA;AAAA;;AACA,UAAA,IAAA,GAAA,MAAA,CAAA,IAAA,CADA,CAEA;AACA;AACA;AACA;AACA;;AACA,WAAA,YAAA,GAAA,IAAA;AACA,UAAA,KAAA,GAAA,IAAA,CAAA,IAAA,CAAA,WAAA,CAAA,GAAA,CAAA;AACA,UAAA,SAAA,GAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CAAA,KAAA,GAAA,CAAA,CAAA;AACA,UAAA,aAAA,GAAA,CAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,MAAA,EAAA,MAAA,CAAA;AACA,UAAA,OAAA,GAAA,IAAA,CAAA,IAAA,GAAA,IAAA,GAAA,IAAA,GAAA,EAAA;;AACA,UAAA,CAAA,OAAA,EAAA;AACA,QAAA,KAAA,CAAA,WAAA,CAAA;AACA,OAFA,MAEA,IAAA,aAAA,CAAA,OAAA,CAAA,SAAA,IAAA,CAAA,EAAA;AACA,QAAA,KAAA,CAAA,SAAA,CAAA;AACA,OAFA,MAEA;AACA,YAAA,GAAA,GAAA,IAAA,QAAA,EAAA;AACA,YAAA,QAAA,GAAA,YAAA,CAAA,OAAA,CAAA,UAAA,CAAA;AACA,QAAA,GAAA,CAAA,MAAA,CAAA,UAAA,EAAA,QAAA;AACA,QAAA,GAAA,CAAA,MAAA,CAAA,MAAA,EAAA,IAAA;AACA,aAAA,MAAA,CAAA;AACA,UAAA,MAAA,EAAA,MADA;AAEA,UAAA,OAAA,EAAA;AAAA,4BAAA;AAAA,WAFA;AAGA,UAAA,GAAA,EAAA,4CAHA;AAIA,UAAA,IAAA,EAAA;AAJA,SAAA,EAKA,IALA,CAKA,UAAA,GAAA,EAAA;AACA,UAAA,KAAA,CAAA,KAAA,CAAA,KAAA,CAAA,UAAA;;AACA,cAAA,CAAA,GAAA,CAAA,IAAA,EAAA;AACA,YAAA,KAAA,CAAA,MAAA,CAAA;AACA,WAFA,MAEA;AACA,YAAA,KAAA,CAAA,iBAAA;AACA;AACA,SAZA,EAYA,UAAA,KAAA,EAAA;AACA,UAAA,KAAA,CAAA,MAAA,CAAA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA,OAAA;AACA,SAfA;AAgBA;AAEA;AAxDA,IARA;AAkEA,EAAA,QAAA,oBACA,QAAA,CAAA,aAAA,EAAA;AAAA,IAAA,IAAA,EAAA;AAAA,GAAA,CADA;AAlEA,CAAA","sourcesContent":["<template>\r\n  <div class=\"uploadimg\">\r\n    <el-upload\r\n        class=\"upload-demo\"\r\n        drag \r\n        action=\"\" \r\n        :limit=\"1\" \r\n        ref=\"clear\"\r\n        :show-file-list=\"false\"\r\n        :http-request=\"uploadImg\"\r\n        multiple>\r\n        <img v-if=\"user.image\" :src=\"require('../assets/userimage/'+user.image)\" style=\"width:100%;height:100%\">\r\n        <i  class=\"el-icon-upload\"></i>\r\n        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n        <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过10M</div>\r\n    </el-upload>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapMutations } from 'vuex'\r\n// import {filesArray} from '@/api/curriculum'\r\nexport default {\r\n    name:'UploadImage',\r\n    data() {\r\n      return {\r\n        // coverImg:'',\r\n        loadingstate:false\r\n      }\r\n    },\r\n    methods: {\r\n      // \r\n      ...mapMutations('userOptions',{updateUserMessage:'UPDATEUSERMESSAGE'}),\r\n\r\n      // beforeUpload(file){\r\n      //   this.loadingstate=true\r\n      //   let index=file.name.lastIndexOf(\".\")\r\n      //   let extension=file.name.substr(index+1)\r\n      //   let extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n      //   const isLimit=file.size / 1024 / 1024 < 10;\r\n      //   if (!isLimit) {\r\n      //     return false\r\n      //   }else if(extensionList.indexOf(extension)<0){\r\n      //     return false\r\n      //   }else{\r\n      //   }\r\n      // },\r\n      uploadImg(params){\r\n        let file=params.file\r\n        // console.log(file);\r\n        // console.log(params);\r\n        // let reader=new FileReader()\r\n        // reader.readAsDataURL(file.raw)\r\n        // console.log(reader.result);\r\n        this.loadingstate=true\r\n        let index=file.name.lastIndexOf(\".\")\r\n        let extension=file.name.substr(index+1)\r\n        let extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n        const isLimit=file.size / 1024 / 1024 < 10;\r\n        if(!isLimit){\r\n          alert(\"文件大小超过10M\")\r\n        }else if(extensionList.indexOf(extension)<0){\r\n          alert(\"文件格式不支持\")\r\n        }else{\r\n          let obj=new FormData()\r\n          let username=localStorage.getItem('username')\r\n          obj.append(\"username\",username)\r\n          obj.append(\"file\",file)\r\n          this.$axios({\r\n            method:\"post\",\r\n            headers:{\"Content-Type\":\"multipart/form-data\"},\r\n            url:'http://localhost:8081/api/user/uploadImage',\r\n            data:obj\r\n          }).then(res=>{\r\n            this.$refs.clear.clearFiles()\r\n            if (!res.data) {\r\n              alert(\"文件为空\")\r\n            }else{\r\n              this.updateUserMessage()\r\n            }\r\n          },error=>{\r\n            alert(\"上传失败\")\r\n            console.log(error.message);\r\n          })\r\n        }\r\n        \r\n      }\r\n    },\r\n    computed:{\r\n      ...mapState('userOptions',{user:'user'})\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.uploadimg{\r\n    position: relative;\r\n    top: 100px;\r\n    left: 200px;\r\n}\r\n</style>"],"sourceRoot":"src/components"}]}