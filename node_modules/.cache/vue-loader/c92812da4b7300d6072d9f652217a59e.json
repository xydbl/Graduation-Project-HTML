{"remainingRequest":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\UploadImage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\UploadImage.vue","mtime":1661237137286},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\babel-loader\\lib\\index.js","mtime":1660272402348},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js","mtime":1660272406551}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapState, mapMutations } from 'vuex'\r\n// import {filesArray} from '@/api/curriculum'\r\nexport default {\r\n    name:'UploadImage',\r\n    data() {\r\n      return {\r\n        // coverImg:'',\r\n        loadingstate:false\r\n      }\r\n    },\r\n    methods: {\r\n      // \r\n      ...mapMutations('userOptions',{updateUserMessage:'UPDATEUSERMESSAGE'}),\r\n\r\n      // beforeUpload(file){\r\n      //   this.loadingstate=true\r\n      //   let index=file.name.lastIndexOf(\".\")\r\n      //   let extension=file.name.substr(index+1)\r\n      //   let extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n      //   const isLimit=file.size / 1024 / 1024 < 10;\r\n      //   if (!isLimit) {\r\n      //     return false\r\n      //   }else if(extensionList.indexOf(extension)<0){\r\n      //     return false\r\n      //   }else{\r\n      //   }\r\n      // },\r\n      uploadImg(params){\r\n        let file=params.file\r\n        // console.log(file);\r\n        // console.log(params);\r\n        // let reader=new FileReader()\r\n        // reader.readAsDataURL(file.raw)\r\n        // console.log(reader.result);\r\n        this.loadingstate=true\r\n        let index=file.name.lastIndexOf(\".\")\r\n        let extension=file.name.substr(index+1)\r\n        let extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n        const isLimit=file.size / 1024 / 1024 < 10;\r\n        if(!isLimit){\r\n          alert(\"文件大小超过10M\")\r\n        }else if(extensionList.indexOf(extension)<0){\r\n          alert(\"文件格式不支持\")\r\n        }else{\r\n          let obj=new FormData()\r\n          let username=localStorage.getItem('username')\r\n          obj.append(\"username\",username)\r\n          obj.append(\"file\",file)\r\n          this.$axios({\r\n            method:\"post\",\r\n            headers:{\"Content-Type\":\"multipart/form-data\"},\r\n            url:'http://localhost:8081/api/user/uploadImage',\r\n            data:obj\r\n          }).then(res=>{\r\n            this.$refs.clear.clearFiles()\r\n            if (!res.data) {\r\n              alert(\"文件为空\")\r\n            }else{\r\n              this.updateUserMessage()\r\n            }\r\n          },error=>{\r\n            alert(\"上传失败\")\r\n            console.log(error.message);\r\n          })\r\n        }\r\n        \r\n      }\r\n    },\r\n    computed:{\r\n      ...mapState('userOptions',{user:'user'})\r\n    }\r\n}\r\n",{"version":3,"sources":["UploadImage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"UploadImage.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"uploadimg\">\r\n    <el-upload\r\n        class=\"upload-demo\"\r\n        drag \r\n        action=\"\" \r\n        :limit=\"1\" \r\n        ref=\"clear\"\r\n        :show-file-list=\"false\"\r\n        :http-request=\"uploadImg\"\r\n        multiple>\r\n        <img v-if=\"user.image\" :src=\"require('../assets/userimage/'+user.image)\" style=\"width:100%;height:100%\">\r\n        <i  class=\"el-icon-upload\"></i>\r\n        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n        <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过10M</div>\r\n    </el-upload>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapMutations } from 'vuex'\r\n// import {filesArray} from '@/api/curriculum'\r\nexport default {\r\n    name:'UploadImage',\r\n    data() {\r\n      return {\r\n        // coverImg:'',\r\n        loadingstate:false\r\n      }\r\n    },\r\n    methods: {\r\n      // \r\n      ...mapMutations('userOptions',{updateUserMessage:'UPDATEUSERMESSAGE'}),\r\n\r\n      // beforeUpload(file){\r\n      //   this.loadingstate=true\r\n      //   let index=file.name.lastIndexOf(\".\")\r\n      //   let extension=file.name.substr(index+1)\r\n      //   let extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n      //   const isLimit=file.size / 1024 / 1024 < 10;\r\n      //   if (!isLimit) {\r\n      //     return false\r\n      //   }else if(extensionList.indexOf(extension)<0){\r\n      //     return false\r\n      //   }else{\r\n      //   }\r\n      // },\r\n      uploadImg(params){\r\n        let file=params.file\r\n        // console.log(file);\r\n        // console.log(params);\r\n        // let reader=new FileReader()\r\n        // reader.readAsDataURL(file.raw)\r\n        // console.log(reader.result);\r\n        this.loadingstate=true\r\n        let index=file.name.lastIndexOf(\".\")\r\n        let extension=file.name.substr(index+1)\r\n        let extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n        const isLimit=file.size / 1024 / 1024 < 10;\r\n        if(!isLimit){\r\n          alert(\"文件大小超过10M\")\r\n        }else if(extensionList.indexOf(extension)<0){\r\n          alert(\"文件格式不支持\")\r\n        }else{\r\n          let obj=new FormData()\r\n          let username=localStorage.getItem('username')\r\n          obj.append(\"username\",username)\r\n          obj.append(\"file\",file)\r\n          this.$axios({\r\n            method:\"post\",\r\n            headers:{\"Content-Type\":\"multipart/form-data\"},\r\n            url:'http://localhost:8081/api/user/uploadImage',\r\n            data:obj\r\n          }).then(res=>{\r\n            this.$refs.clear.clearFiles()\r\n            if (!res.data) {\r\n              alert(\"文件为空\")\r\n            }else{\r\n              this.updateUserMessage()\r\n            }\r\n          },error=>{\r\n            alert(\"上传失败\")\r\n            console.log(error.message);\r\n          })\r\n        }\r\n        \r\n      }\r\n    },\r\n    computed:{\r\n      ...mapState('userOptions',{user:'user'})\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.uploadimg{\r\n    position: relative;\r\n    top: 100px;\r\n    left: 200px;\r\n}\r\n</style>"]}]}