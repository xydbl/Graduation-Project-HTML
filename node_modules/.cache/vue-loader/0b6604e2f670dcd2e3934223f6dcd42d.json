{"remainingRequest":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\EditBlog.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\components\\EditBlog.vue","mtime":1660805143106},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\babel-loader\\lib\\index.js","mtime":1660272402348},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js","mtime":1660272406551}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapState, mapMutations } from 'vuex'\r\nexport default {\r\n    name:'EditBlog',\r\n    data() {\r\n\t\treturn {\r\n\t\t\ttitle:this.btitle,\r\n\t\t\ttype:this.btype,\r\n\t\t\tcontent:this.bcontent,\r\n\t\t\timg:this.bimg,\r\n      //  修改时间\r\n\t\t\tnewTime:new Date()\r\n\t\t}\r\n\t},\r\n\tprops:['bid','btitle','btype','bimg','bcontent'],\r\n\tmethods: {\r\n\t\t...mapMutations('blogOptions',{currentBlog:'CURRENTBLOG'}),\r\n\t\tupdateBlogImg(params){\r\n\t\t\tlet file=params.file\r\n\t\t\tlet index=file.name.lastIndexOf(\".\")\r\n\t\t\tlet extension=file.name.substr(index+1)\r\n\t\t\tlet extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n\t\t\tconst isLimit=file.size / 1024 / 1024 < 10;\r\n\t\t\tif(!isLimit){\r\n\t\t\t\talert(\"文件大小超过10M\")\r\n\t\t\t}else if(extensionList.indexOf(extension)<0){\r\n\t\t\t\talert(\"文件格式不支持\")\r\n\t\t\t}else{\r\n\t\t\t\tlet obj=new FormData()\r\n\t\t\t\tobj.append('file',file)\r\n\t\t\t\tobj.append('bid',this.bid)\r\n\t\t\t\tthis.$axios({\r\n\t\t\t\t\tmethod:'post',\r\n\t\t\t\t\turl:'http://localhost:8081/api/blog/uploadInEdit',\r\n\t\t\t\t\tdata:obj\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tthis.img=res.data.bimage\r\n\t\t\t\t\t// sessionStorage.setItem('isEdit',JSON.stringify(res.data))\r\n\t\t\t\t},error=>{\r\n\t\t\t\t\tconsole.log(error.message);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n        // 图片上传 Mavob-Editor\r\n        imgAdd(pos, file){\r\n            let formData=new FormData()\r\n            formData.append('file',file)\r\n            this.$axios({\r\n                method:'post',\r\n                url:'http://localhost:8081/api/mavon/addImg',\r\n                data:formData\r\n            }).then(res=>{\r\n                let url='/MavonImg/'+res.data\r\n                this.$refs.md.$img2Url(pos,url)\r\n            })\r\n        },\r\n        // 修改完成\r\n\t\teditFinish(){\r\n\t\t\tthis.$axios.post('http://localhost:8081/api/blog/save',{\r\n\t\t\t\tbid:this.bid||this.blog.bid,\r\n\t\t\t\tbtitle:this.title,\r\n\t\t\t\tbtype:this.type,\r\n\t\t\t\tbcontent:this.content,\r\n\t\t\t\tbstate:1\r\n\t\t\t}).then(res=>{\r\n\t\t\t\t// res.data\r\n\t\t\t\tthis.$router.back()\r\n\t\t\t},error=>{\r\n\t\t\t\tconsole.log(error.message);\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\tcomputed:{\r\n\t\t...mapState('userOptions',{user:'user'}),\r\n\t\t...mapState('blogOptions',{blog:'blog'})\r\n\t},\r\n\tmounted(){\r\n\t\tlet isEdit=sessionStorage.getItem('isEdit')\r\n\t\tif(isEdit==''||isEdit==undefined||isEdit==null){\r\n\t\t\tsessionStorage.setItem('isEdit',this.bid)\r\n\t\t\t// this.updateBid(this.bid)\r\n\t\t\tthis.currentBlog(this.bid)\r\n\t\t}else{\r\n\t\t\tthis.currentBlog(isEdit)\r\n\t\t}\r\n\t\tsetTimeout(() => {\r\n\t\t\tsessionStorage.setItem('editBlog',JSON.stringify(this.blog))\r\n\t\t}, 300);\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet editBlog=sessionStorage.getItem('editBlog')\r\n\t\t\tif(editBlog!=''&&editBlog!=null){\r\n\t\t\t\teditBlog=JSON.parse(editBlog)\r\n\t\t\t\tthis.title=editBlog.btitle\r\n\t\t\t\tthis.type=editBlog.btype\r\n\t\t\t\tthis.content=editBlog.bcontent\r\n\t\t\t\tthis.img=editBlog.bimage\r\n\t\t\t}\r\n\t\t}, 400);\r\n\t}\r\n}\r\n",{"version":3,"sources":["EditBlog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EditBlog.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"editing\">\r\n\t\t<div class=\"left\">\r\n\t\t\t<span>请输入标题：</span><br>\r\n\t\t\t<span>类型：</span><br>\r\n\t\t\t<span>请选择封面：</span><br>\r\n\t\t\t<span class=\"bcontent\">内容：</span>\r\n\t\t</div>\r\n\t\t<div style=\"position: absolute; right:30px;top:20px\">\r\n\t\t\t<button class=\"btn\" @click=\"editFinish\">修改完成/发布</button>\r\n\t\t</div>\r\n\t\t<div class=\"right\">\r\n\t\t\t\r\n\t\t\t<input type=\"text\" class=\"titleIn\" v-model=\"title\"><br>\r\n\t\t\t<!-- <select name=\"\" class=\"stype\" v-model=\"type\">\r\n\t\t\t\t<option value=\"\">xxxx</option>\r\n\t\t\t</select><br> -->\r\n\t\t\t<input type=\"text\" v-model=\"type\" class=\"ipt\">\r\n\t\t\t<!-- <input type=\"file\" class=\"checkImg\" accept=\".png, .jpg, .jpeg\"><br> -->\r\n\t\t\t<div class=\"updateBlogImage\">\r\n\t\t\t\t<el-upload\r\n\t\t\t\t\tclass=\"upload-demo\" \r\n\t\t\t\t\tdrag \r\n\t\t\t\t\taction=\"\" \r\n\t\t\t\t\t:http-request=\"updateBlogImg\" \r\n\t\t\t\t\t:limit=\"1\" \r\n\t\t\t\t\tmultiple>\r\n\t\t\t\t\t<img v-if=\"img\" :src=\"require('../assets/blogimage/'+img)\">\r\n\t\t\t\t\t<i v-else class=\"el-icon-upload\"></i>\r\n\t\t\t\t\t<div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n\t\t\t\t\t<div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过10M</div>\r\n\t\t\t\t</el-upload>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"mavonEditor\">\r\n\t\t\t\t<mavon-editor v-model=\"content\" @imgAdd=\"imgAdd\" ref=\"md\" />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapMutations } from 'vuex'\r\nexport default {\r\n    name:'EditBlog',\r\n    data() {\r\n\t\treturn {\r\n\t\t\ttitle:this.btitle,\r\n\t\t\ttype:this.btype,\r\n\t\t\tcontent:this.bcontent,\r\n\t\t\timg:this.bimg,\r\n      //  修改时间\r\n\t\t\tnewTime:new Date()\r\n\t\t}\r\n\t},\r\n\tprops:['bid','btitle','btype','bimg','bcontent'],\r\n\tmethods: {\r\n\t\t...mapMutations('blogOptions',{currentBlog:'CURRENTBLOG'}),\r\n\t\tupdateBlogImg(params){\r\n\t\t\tlet file=params.file\r\n\t\t\tlet index=file.name.lastIndexOf(\".\")\r\n\t\t\tlet extension=file.name.substr(index+1)\r\n\t\t\tlet extensionList=[\"png\",\"PNG\",\"jpg\",\"JPG\",\"jpeg\",\"JPEG\"]\r\n\t\t\tconst isLimit=file.size / 1024 / 1024 < 10;\r\n\t\t\tif(!isLimit){\r\n\t\t\t\talert(\"文件大小超过10M\")\r\n\t\t\t}else if(extensionList.indexOf(extension)<0){\r\n\t\t\t\talert(\"文件格式不支持\")\r\n\t\t\t}else{\r\n\t\t\t\tlet obj=new FormData()\r\n\t\t\t\tobj.append('file',file)\r\n\t\t\t\tobj.append('bid',this.bid)\r\n\t\t\t\tthis.$axios({\r\n\t\t\t\t\tmethod:'post',\r\n\t\t\t\t\turl:'http://localhost:8081/api/blog/uploadInEdit',\r\n\t\t\t\t\tdata:obj\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tthis.img=res.data.bimage\r\n\t\t\t\t\t// sessionStorage.setItem('isEdit',JSON.stringify(res.data))\r\n\t\t\t\t},error=>{\r\n\t\t\t\t\tconsole.log(error.message);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n        // 图片上传 Mavob-Editor\r\n        imgAdd(pos, file){\r\n            let formData=new FormData()\r\n            formData.append('file',file)\r\n            this.$axios({\r\n                method:'post',\r\n                url:'http://localhost:8081/api/mavon/addImg',\r\n                data:formData\r\n            }).then(res=>{\r\n                let url='/MavonImg/'+res.data\r\n                this.$refs.md.$img2Url(pos,url)\r\n            })\r\n        },\r\n        // 修改完成\r\n\t\teditFinish(){\r\n\t\t\tthis.$axios.post('http://localhost:8081/api/blog/save',{\r\n\t\t\t\tbid:this.bid||this.blog.bid,\r\n\t\t\t\tbtitle:this.title,\r\n\t\t\t\tbtype:this.type,\r\n\t\t\t\tbcontent:this.content,\r\n\t\t\t\tbstate:1\r\n\t\t\t}).then(res=>{\r\n\t\t\t\t// res.data\r\n\t\t\t\tthis.$router.back()\r\n\t\t\t},error=>{\r\n\t\t\t\tconsole.log(error.message);\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\tcomputed:{\r\n\t\t...mapState('userOptions',{user:'user'}),\r\n\t\t...mapState('blogOptions',{blog:'blog'})\r\n\t},\r\n\tmounted(){\r\n\t\tlet isEdit=sessionStorage.getItem('isEdit')\r\n\t\tif(isEdit==''||isEdit==undefined||isEdit==null){\r\n\t\t\tsessionStorage.setItem('isEdit',this.bid)\r\n\t\t\t// this.updateBid(this.bid)\r\n\t\t\tthis.currentBlog(this.bid)\r\n\t\t}else{\r\n\t\t\tthis.currentBlog(isEdit)\r\n\t\t}\r\n\t\tsetTimeout(() => {\r\n\t\t\tsessionStorage.setItem('editBlog',JSON.stringify(this.blog))\r\n\t\t}, 300);\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet editBlog=sessionStorage.getItem('editBlog')\r\n\t\t\tif(editBlog!=''&&editBlog!=null){\r\n\t\t\t\teditBlog=JSON.parse(editBlog)\r\n\t\t\t\tthis.title=editBlog.btitle\r\n\t\t\t\tthis.type=editBlog.btype\r\n\t\t\t\tthis.content=editBlog.bcontent\r\n\t\t\t\tthis.img=editBlog.bimage\r\n\t\t\t}\r\n\t\t}, 400);\r\n\t}\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.editing{\r\n\twidth: 1200px;\r\n\theight: 800px;\r\n\tposition: relative;\r\n\tleft: 40px;\r\n\tborder: 1px solid silver;\r\n}\r\n.left{\r\n\tposition: relative;\r\n\twidth: 130px;\r\n\theight: 500px;\r\n\tleft: 20px;\r\n  top: 65px;\r\n\tfont-size: 18px;\r\n\ttext-align: right;\r\n}\r\n.right{\r\n\tposition: relative;\r\n\twidth: 950px;\r\n\theight: 500px;\r\n\ttop: -440px;\r\n\tleft: 160px;\r\n}\r\ninput{\r\n\theight: 30px;\r\n\twidth: 360px;\r\n}\r\nspan{\r\n\tmargin: 10px;\r\n\tline-height: 40px;\r\n}\r\n.titleIn,.ipt{\r\n\tborder-top: 0;\r\n\tborder-left: 0;\r\n\tborder-right: 0;\r\n\tborder-bottom: 1px solid darkgrey;\r\n\t/* border: 0; */\r\n\tmargin-top: 5px;\r\n\toutline: none;\r\n}\r\n.updateBlogImage{\r\n\tmargin-top: 30px;\r\n}\r\n.bcontent{\r\n\tposition: relative;\r\n\ttop: 210px;\r\n}\r\n.mavonEditor{\r\n\tmargin-top: 30px;\r\n}\r\n/* .stype{\r\n\tposition: relative;\r\n\ttop: 21px;\r\n\theight: 30px;\r\n\twidth: 70px;\r\n} */\r\n/* .checkImg{\r\n\tposition: relative;\r\n\ttop: 40px;\r\n} */\r\n/* .ptext{\r\n\tposition: relative;\r\n\ttop: 50px;\r\n} */\r\n.btn{\r\n\tposition: relative;\r\n\t/* top: 60px; */\r\n\t/* left: 700px; */\r\n\twidth: 100px;\r\n\theight: 30px;\r\n}\r\n</style>"]}]}