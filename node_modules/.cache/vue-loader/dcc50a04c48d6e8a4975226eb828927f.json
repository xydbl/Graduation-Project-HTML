{"remainingRequest":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\page\\Blog.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\src\\page\\Blog.vue","mtime":1660272407116},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\babel-loader\\lib\\index.js","mtime":1660272402348},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660272402559},{"path":"D:\\HBuilderProjects\\vue2\\Graduation-Project-HTML\\node_modules\\vue-loader\\lib\\index.js","mtime":1660272406551}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapMutations, mapState } from 'vuex'\r\nimport {marked} from 'marked'\r\nexport default {\r\n    name:'Blog',\r\n    data() {\r\n      return {\r\n        commentary:'',\r\n        username:'',\r\n        list:[]\r\n      }\r\n    },\r\n    props:[\"bid\",\"btype\",'btitle','bcontent','btime'],\r\n    methods:{\r\n      // 获取博主信息\r\n      ...mapMutations(\"userOptions\",{getBlogUserMessage:'GETBLOGUSERMESSAGE'}),\r\n      ...mapMutations(\"blogOptions\",{currentBlog:'CURRENTBLOG'}),\r\n      // 获取评论\r\n      ...mapMutations('commentaryOptions',{currentCommentary:'CURRENTCOMMENTARY'}),\r\n      // 发送评论\r\n      sendComm(){\r\n        if(this.commentary!=''){\r\n          this.$axios.post('http://localhost:8081/api/commentary/add',{\r\n            message:this.commentary,\r\n            messageId:this.user.uid,\r\n            ctime:new Date(),\r\n            ctype:0,\r\n            clogId:this.blog.bid||this.bid\r\n          }).then(res=>{\r\n            this.commentary=''\r\n            this.currentCommentary(this.blog.bid ||this.bid)\r\n          },error=>{\r\n            console.log(error.message);\r\n          })\r\n        }else{\r\n          alert('不能为空')\r\n        }\r\n        \r\n      },\r\n      // 过滤评论\r\n      approvedComment(){\r\n        this.list=this.commentaryList\r\n        this.list=this.list.filter((li)=>{\r\n          return li.ctype==1\r\n        })\r\n      }\r\n    },\r\n    computed:{\r\n      ...mapState('userOptions',{user:'user',blogUser:'blogUser'}),\r\n      ...mapState('blogOptions',{blog:'blog'}),\r\n      ...mapState('commentaryOptions',{commentaryList:'commentaryList'}),\r\n      compiledMarkdown(){\r\n        return marked.parse(this.bcontent||this.blog.bcontent||'',{sanitize:true})\r\n      }\r\n    },\r\n    mounted(){\r\n        let bid=sessionStorage.getItem(\"getbid\")\r\n        if (bid==null||bid=='') {\r\n          // console.log(this.bid);\r\n          this.getBlogUserMessage(this.bid)\r\n          sessionStorage.setItem(\"getbid\",this.bid)\r\n          this.currentCommentary(this.bid)\r\n        }else{\r\n          let bid=sessionStorage.getItem(\"getbid\")\r\n          this.getBlogUserMessage(bid)\r\n          this.currentBlog(bid)\r\n          this.currentCommentary(bid)\r\n        }\r\n        setTimeout(() => {\r\n          this.username=this.blogUser.username \r\n        }, 200);\r\n        setInterval(() => {\r\n          this.approvedComment()\r\n        }, 500);\r\n       \r\n    }\r\n}\r\n",{"version":3,"sources":["Blog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Blog.vue","sourceRoot":"src/page","sourcesContent":["<template>\r\n  <div class=\"bbody\">\r\n    <div class=\"bmain\">\r\n      <div style=\"border-bottom: 1px solid red; width:630px\">\r\n        <!-- 标题 -->\r\n        <h1>{{btitle||blog.btitle}}</h1>\r\n        <span style=\"position: relative; left: 10px;bottom: 5px;\">\r\n          发布人：\r\n          <router-link replace :to=\"{\r\n            name:'showUsr',\r\n            params:{\r\n              uid:this.blogUser.uid,\r\n              username:username,\r\n              image:this.blogUser.image\r\n            }\r\n            }\">{{username}}</router-link>\r\n        </span>\r\n        <span style=\"position: relative; left: 270px;bottom: 5px;\">发布时间：2020-08-09 07:25:33</span>\r\n      </div>\r\n\t    <!-- 正文 -->\r\n      <div>\r\n        <div v-html=\"compiledMarkdown\"></div>\r\n\t    </div>\r\n      <!-- 评论 -->\r\n      <div style=\"position: relative;border-bottom: 1px solid #7E8388;top:20px\">\r\n        <el-badge :value=\"200\" :max=\"99\" class=\"item\" style=\"font-size: 20px;\">\r\n          评论\r\n        </el-badge>\r\n      </div>\r\n      <div class=\"botm\">\r\n        <div>\r\n\t\t\t  <input type=\"text\" placeholder=\"进行评论\" v-model=\"commentary\"><button @click=\"sendComm\">发表评论</button>\r\n\t\t  </div>\r\n        <div style=\"margin-left:20px;margin-top:10px;border-bottom:1px solid black\" v-for=\" comm in list\" :key=\"comm.cid\">\r\n          <div>\r\n            <h2>{{comm.messageId}}</h2>\r\n            <p>&nbsp&nbsp{{comm.message}}</p>\r\n            <div style=\"text-align:left;\">\r\n              <span style=\"margin-bottom:10px;\">{{comm.ctime}}</span>\r\n              <span >\r\n                <img v-if=\"false\" src=\"../assets/Active.png\" alt=\"\" style=\"width:20px;height:20px;margin-left:10px;cursor: pointer;\">\r\n                <img v-if=\"true\" src=\"../assets/White.png\" alt=\"\" style=\"width:20px;height:20px;margin-left:10px;cursor: pointer;\">\r\n              </span>\r\n              <span style=\"margin-left:6px\">1</span>\r\n              <span class=\"reply\">回复</span>\r\n            </div>\r\n            <div></div>\r\n          </div>\r\n          <!-- <ul>\r\n            <li v-for=\" comm in list\" :key=\"comm.cid\"><span>{{comm.messageId}}</span><br><br>{{comm.message}}<br><span style=\"font-size:10px\">评论时间:{{comm.ctime}}</span></li>\r\n          </ul> -->\r\n        </div>\r\n\t\t  \r\n      </div>\r\n      \r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations, mapState } from 'vuex'\r\nimport {marked} from 'marked'\r\nexport default {\r\n    name:'Blog',\r\n    data() {\r\n      return {\r\n        commentary:'',\r\n        username:'',\r\n        list:[]\r\n      }\r\n    },\r\n    props:[\"bid\",\"btype\",'btitle','bcontent','btime'],\r\n    methods:{\r\n      // 获取博主信息\r\n      ...mapMutations(\"userOptions\",{getBlogUserMessage:'GETBLOGUSERMESSAGE'}),\r\n      ...mapMutations(\"blogOptions\",{currentBlog:'CURRENTBLOG'}),\r\n      // 获取评论\r\n      ...mapMutations('commentaryOptions',{currentCommentary:'CURRENTCOMMENTARY'}),\r\n      // 发送评论\r\n      sendComm(){\r\n        if(this.commentary!=''){\r\n          this.$axios.post('http://localhost:8081/api/commentary/add',{\r\n            message:this.commentary,\r\n            messageId:this.user.uid,\r\n            ctime:new Date(),\r\n            ctype:0,\r\n            clogId:this.blog.bid||this.bid\r\n          }).then(res=>{\r\n            this.commentary=''\r\n            this.currentCommentary(this.blog.bid ||this.bid)\r\n          },error=>{\r\n            console.log(error.message);\r\n          })\r\n        }else{\r\n          alert('不能为空')\r\n        }\r\n        \r\n      },\r\n      // 过滤评论\r\n      approvedComment(){\r\n        this.list=this.commentaryList\r\n        this.list=this.list.filter((li)=>{\r\n          return li.ctype==1\r\n        })\r\n      }\r\n    },\r\n    computed:{\r\n      ...mapState('userOptions',{user:'user',blogUser:'blogUser'}),\r\n      ...mapState('blogOptions',{blog:'blog'}),\r\n      ...mapState('commentaryOptions',{commentaryList:'commentaryList'}),\r\n      compiledMarkdown(){\r\n        return marked.parse(this.bcontent||this.blog.bcontent||'',{sanitize:true})\r\n      }\r\n    },\r\n    mounted(){\r\n        let bid=sessionStorage.getItem(\"getbid\")\r\n        if (bid==null||bid=='') {\r\n          // console.log(this.bid);\r\n          this.getBlogUserMessage(this.bid)\r\n          sessionStorage.setItem(\"getbid\",this.bid)\r\n          this.currentCommentary(this.bid)\r\n        }else{\r\n          let bid=sessionStorage.getItem(\"getbid\")\r\n          this.getBlogUserMessage(bid)\r\n          this.currentBlog(bid)\r\n          this.currentCommentary(bid)\r\n        }\r\n        setTimeout(() => {\r\n          this.username=this.blogUser.username \r\n        }, 200);\r\n        setInterval(() => {\r\n          this.approvedComment()\r\n        }, 500);\r\n       \r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.bbody{\r\n  position: absolute;\r\n  left: 400px;\r\n  width: 650px;\r\n  height: 700px;\r\n}\r\n.bmain{\r\n  position: absolute;\r\n  left: 20px;\r\n}\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.botm{\r\n  position: relative;\r\n  top: 25px;\r\n  font-size: 18px;\r\n}\r\n.botm input{\r\n\theight: 30px;\r\n\twidth: 550px;\r\n}\r\n.botm button{\r\n\theight: 35px;\r\n}\r\n.botm ul li{\r\n  list-style-type: decimal;\r\n}\r\n.botm span{\r\n  font-size: 14px;\r\n}\r\n.reply{\r\n  margin-left:10px;\r\n  cursor: pointer;\r\n}\r\n.reply:hover{\r\n  color: skyblue;\r\n}\r\n</style>"]}]}